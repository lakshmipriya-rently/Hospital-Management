<div class="d-flex justify-content-center align-items-center min-vh-100 bg-light">
  <div class="card shadow-lg p-4 rounded-4" style="max-width: 700px; width: 100%;">
    <h1 class="text-center mb-4 text-primary fw-bold">New Doctor</h1>

    <%= form_with model: @doctor, url: doctors_path(user_id: @user.id), local: true, html: { class: "needs-validation" } do |form| %>

      <% if @doctor.errors.any? %>
        <div class="alert alert-danger">
          <h4><%= pluralize(@doctor.errors.count, "error") %> prohibited this doctor from being saved:</h4>
          <ul>
            <% @doctor.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- License ID -->
      <div class="mb-3">
        <%= form.label :license_id, "License ID", class: "form-label fw-semibold" %>
        <%= form.text_field :license_id, class: "form-control" %>
      </div>

      <!-- Experience -->
      <div class="mb-3">
        <%= form.label :experience, class: "form-label fw-semibold" %>
        <%= form.number_field :experience, class: "form-control" %>
      </div>

      <!-- Degree -->
      <div class="mb-3">
        <%= form.label :type_of_degree, "Degree Type", class: "form-label fw-semibold" %>
        <%= form.select :type_of_degree,
                        ['MBBS','MD','DO','BDS','MS','MCh','DM','DNB','PhD','FRCS'],
                        { prompt: 'Select a category' },
                        { class: "form-select" } %>
      </div>

      <!-- Salary -->
      <div class="mb-3">
        <%= form.label :salary, class: "form-label fw-semibold" %>
        <%= form.number_field :salary, min: 1000, class: "form-control" %>
      </div>

      <!-- Specializations -->
      <h4 class="mt-4 text-secondary fw-bold">Specializations</h4>
      <div class="mb-4">
        <%= form.label :specialization_ids, "Select Specializations", class: "form-label fw-semibold" %>
        <%= form.collection_select :specialization_ids, Specialization.all, :id, :specialization,
                                   {}, { multiple: true, class: "form-select", size: 6 } %>
        <small class="form-text text-muted">Hold Ctrl (Windows) or Command (Mac) to select multiple options.</small>
      </div>

      <!-- Availability -->
      <h4 class="mt-4 text-secondary fw-bold">Doctor Availability</h4>
      <%= form.fields_for :available do |a| %>
        <!-- Days -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Available Days</label>
          <div class="d-flex flex-wrap gap-3">
            <% Date::DAYNAMES.each do |day| %>
              <div class="form-check">
                <%= check_box_tag "doctor[available_attributes][available_days][]", day, @doctor.available&.available_days&.include?(day), class: "form-check-input", id: "available_days_#{day}" %>
                <%= label_tag "available_days_#{day}", day, class: "form-check-label" %>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Time Slots -->
        <div class="row">
          <div class="col-md-6 mb-3">
            <%= a.label :start_time, class: "form-label fw-semibold" %>
            <%= a.time_select :start_time, {}, class: "form-select form-select-sm" %>
          </div>
          <div class="col-md-6 mb-3">
            <%= a.label :end_time, class: "form-label fw-semibold" %>
            <%= a.time_select :end_time, {}, class: "form-select form-select-sm" %>
          </div>
        </div>

        <!-- Active -->
        <div class="form-check mb-3">
          <%= a.check_box :is_active, class: "form-check-input", checked: true %>
          <%= a.label :is_active, "Available", class: "form-check-label" %>
        </div>
      <% end %>

      <!-- Submit -->
      <div class="d-grid">
        <%= form.submit "Create Doctor", class: "btn btn-primary btn-lg fw-semibold" %>
      </div>

    <% end %>
  </div>
</div>
